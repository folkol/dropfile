<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset=utf-8>
    <title>Dropskji</title>
    <script type="text/javascript" src="jquery-1.11.1.min.js"></script>
    <style>
    html, body {
      height: 100%;
      background-color: black;
    }
    #droparea {
      height: 70%;
      margin: 20px;
      border: dashed gray 10px;
      color: gray;
    }
    #droparea.hover {
      height: 70%;
      margin: 20px;
      border: dashed white 10px;
      color: white;
    }
    #droparea p {
      text-align: center;
      font-size: 50px;
    }
    a {
      color: white;
    }
    </style>
</head>
<body>
  <div id="droparea">
    <p>DROP FILES!</p>
  </div>
  <div>
    <ul id="files">
    </ul>
  </div>
  <script>
    var uploadFile = function(file) {
        var reader = new FileReader();
        reader.onload = function (event) {
          $.ajax({
             url: 'files/' + file.name,
             type: 'POST',
             data: event.target.result,
             processData: false,
             success: function(filename) {
               var li = $("<li>").append($('<a href="files/' + filename + '">File: ' + file.name + '</a>'));
               $("#files").append(li);
             }
          });
        };
        reader.readAsArrayBuffer(file);      
    }
    window.ondragover = function (e) {
      e.preventDefault();
      $("#droparea").addClass("hover");
    };
    window.ondragleave = function (e) {
      $("#droparea").removeClass("hover");
    };
    window.ondrop = function (e) {
      e.preventDefault();
      $("#droparea").removeClass("hover");

      var files = e.dataTransfer.files;
      for(i = 0; i < files.length; i++) {
        uploadFile(files[i]);
      }
    };
  </script>
</body>
</html>
